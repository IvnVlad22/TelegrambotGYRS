# Гурс бот
## Файлы и папки, организация кода
- src - находятся файлы, для работы бота
- model - файлы, для работы с Базой данных
- parsing - файлы, для парсинга данных
---
- check_id.py - проверка id при отправке сообщения пользователям (хорошо бы тоже в папку, но не придумал)
---
- .gitignore - в нем хранятся названия файлов и папкоу, которые не нужно закидывать в github (например файл с конфигом, папки с кэшем (__pycache__ как раз папка с кэшем), системные файлы)

- bot.py - основной файл для запуска бота

- dump.txt - дамп базы данных (обычно вроде хранят в .db , но у нас уже есть my.db так что решил в txt)

- my.db - база данных, туда записываем все сообщения, отправленные боту

- READEM.md - файл для гайдов, там и тд, сам знаешь

---
(вообще по хорошему в паку sqr нужно запихать всего бота, все его функции, а в самом bot.py оставить только 5-6 строчек для запуска самого бота)

Совет: очень поплуярна система организации кода - MVC (model-view-controller)
- model - работа с бд или файлы и тд
- view - работа с выводом пользоателю (веб-html TG-Bot
- вывод сообщений пользователю)
 Есть разные вариации MVC, в зависимости от платформы приложений и выебонов тимлида

---

## Как работает бот

### Библиотеки
```
import json  -    для разбора json строки
import requests - для получения ответов (по ссылке)
import telebot - сам тг бот
from telebot import types - ну типы, хззх
import datetime - для получения времени
import time - для ожидания программы (ну типо подождать 2 сек и продолжить выполнение кода)

--- Ну а тут просто импортируем функции из других файлов ---

from src.parsing.parse import get_teachers, get_lessons
from src.parsing.findpic import get_images
from src.check_id import chk
from src.parsing.timecheck import tmchk
from src.model.con import db_insert

--- Библиотека для web-драйверв
from selenium import webdriver
from selenium.webdriver.chrome.options import Options
from selenium.common.exceptions import WebDriverException


import sqlite3 -- библиотека для Базы данных
```


### База Данных:

Препод сказал использовать sqlite, какая-то легкая бд, сам с ней впервые работал, так что погуглишь

Использует язык запросов SQL, так что все как обычно

Странно, то горячее подклбчение БД не захотела использовать, то есть при кажждом запросе мы подклбчаемся к БД, записыаем запрос и закарываем соединение. У меня в Postgre подключение всегда, а тут, приходится его каждый раз закрывать и открывать, погугли про это, может в этом и есть прикол sqllite


при запуске бота, весь код, что не в функциях в файлах выполняется, ну и там мы проверем подключение к БД, чуть ниже написана функция записи данных:
```
def db_insert(txt: str):
```

Функция принемает строку и записывает ее в БД, эту функцию вызываю при каждом приходе комманды или текса в bot.py


### Парсин

Ну про парсинг ты и так знаешь, через хром заходим в браузер, выполняем там JavaScript код (скрипт, тофтология хыхы) получаем нужные данные и закидываем их в переменные или ключ:значенеи

Эти ключ:значение при перезапуске бота (именно программно, не в ТГ) очищаются, поэтому кнопка с именем препода не сработает при перезапуске бота, при перезапуске вообще лучше всегда выполнить команду start на всякий случай


### Таймчек

в файле timecheck.py (кстати, он лежит в папке парсинг, не логично, надо его перекинуть в другую, ну да лдно)

НУ просто получаем сообщение, из него берем время призода сообщения, сравниваем с настоящим временем и возвращаем либо true либо false


### Чека id

ну просто зекаем id и возвращаем либо true либо false

Ну вроде все, если будут вопросы 0 пиши